# Network 답변 모음 (41-44)

## 41. DHCP에서 UDP를 사용하는 이유가 무엇인가요?

DHCP가 UDP를 사용하는 이유는 **클라이언트가 아직 IP 주소를 받지 못한 상태**에서 동작해야 하기 때문입니다.

**부트스트랩 문제:**
DHCP의 목적 자체가 IP 주소를 할당하는 것인데, TCP는 연결 수립을 위해 이미 IP 주소가 필요합니다. 3-way handshake를 수행하려면 양쪽 모두 유효한 IP 주소가 있어야 하는데, 클라이언트는 아직 IP가 없는 상태입니다.

**브로드캐스트 지원:**
DHCP 초기 단계에서는 서버의 위치를 모르므로 브로드캐스트로 메시지를 보내야 합니다. UDP는 브로드캐스트를 지원하지만 TCP는 일대일 연결만 가능합니다. Discover 메시지를 255.255.255.255로 보내 모든 DHCP 서버가 받을 수 있도록 합니다.

**단순한 요청-응답 구조:**
DHCP는 복잡한 연결 관리가 필요 없는 단순한 요청-응답 패턴입니다. Discover-Offer-Request-Acknowledge의 4단계 메시지 교환만으로 충분합니다. TCP의 연결 설정, 유지, 종료 오버헤드가 불필요합니다.

**낮은 오버헤드:**
IP 주소 할당은 빠르게 완료되어야 합니다. 네트워크에 연결할 때마다 수행되므로 지연이 사용자 경험에 직접 영향을 줍니다. UDP의 낮은 오버헤드로 빠른 처리가 가능합니다.

**상태 비저장:**
DHCP 서버는 수천 대의 클라이언트를 처리해야 할 수 있습니다. UDP의 비연결 특성으로 각 클라이언트마다 연결 상태를 유지할 필요가 없어 서버 부담이 줄어듭니다.

**신뢰성 보장 방법:**
UDP는 신뢰성이 없지만 DHCP는 애플리케이션 레벨에서 재전송을 구현합니다. 클라이언트가 일정 시간 내에 응답을 받지 못하면 요청을 재전송합니다. 지수 백오프(exponential backoff)로 재전송 간격을 늘려 네트워크 부담을 줄입니다.

**멀티캐스트 가능성:**
일부 DHCP 구현은 멀티캐스트도 활용합니다. UDP는 멀티캐스트를 지원하지만 TCP는 불가능합니다.

**특수한 주소 사용:**
클라이언트는 송신 주소로 0.0.0.0을 사용할 수 있어야 합니다. TCP는 유효한 IP 주소가 필요하지만 UDP는 이러한 특수 주소를 허용합니다.

**역사적 배경:**
DHCP의 전신인 BOOTP도 UDP를 사용했습니다. DHCP는 BOOTP와 호환성을 유지하기 위해 같은 포트(67, 68)와 프로토콜(UDP)을 사용합니다.

**포트 번호의 의미:**
서버는 67번, 클라이언트는 68번 포트를 사용합니다. 클라이언트 포트가 고정된 이유는 브로드캐스트 응답을 받기 위함입니다. IP 주소가 없는 상태에서 특정 클라이언트에게 유니캐스트할 수 없으므로 고정 포트로 브로드캐스트합니다.

**방화벽 설정:**
UDP 67, 68번 포트만 허용하면 DHCP 트래픽을 제어할 수 있습니다. TCP를 사용했다면 더 복잡한 상태 추적이 필요했을 것입니다.

**네트워크 부하:**
대규모 네트워크에서 수백 대가 동시에 부팅할 때, TCP 연결 설정의 오버헤드는 상당한 부하를 발생시킵니다. UDP는 이를 최소화합니다.

**결론:**
DHCP의 특수한 동작 환경(IP 주소가 없는 상태, 브로드캐스트 필요, 단순한 교환)을 고려하면 UDP가 필수적이고 자연스러운 선택입니다.

---

## 42. DHCP에서, IP 주소 말고 추가로 제공해주는 정보가 있나요?

네, DHCP는 IP 주소 외에도 **네트워크 동작에 필요한 다양한 설정 정보**를 제공합니다.

**서브넷 마스크(Subnet Mask):**
IP 주소의 네트워크 부분과 호스트 부분을 구분하는 정보입니다. 클라이언트가 같은 네트워크 내의 장치를 식별하는 데 필수적입니다. 예를 들어 255.255.255.0은 /24 네트워크를 의미합니다.

**기본 게이트웨이(Default Gateway):**
외부 네트워크로 패킷을 보낼 때 사용하는 라우터의 IP 주소입니다. 클라이언트가 인터넷에 접속하려면 반드시 필요합니다. 일반적으로 공유기나 라우터의 IP 주소가 됩니다.

**DNS 서버 주소:**
도메인 이름을 IP 주소로 변환하는 DNS 서버의 주소입니다. 여러 DNS 서버를 제공할 수 있으며, 우선순위에 따라 사용합니다. 이것이 없으면 도메인 이름으로 접속할 수 없고 IP 주소를 직접 입력해야 합니다.

**임대 시간(Lease Time):**
할당된 IP 주소를 사용할 수 있는 기간입니다. 초 단위로 표현되며, 일반적으로 몇 시간에서 며칠입니다. 임대 시간이 지나면 클라이언트는 갱신을 요청하거나 새로운 주소를 받아야 합니다.

**도메인 이름(Domain Name):**
클라이언트가 속한 도메인의 이름입니다. 예를 들어 "company.local" 같은 값입니다. FQDN(Fully Qualified Domain Name) 구성에 사용됩니다.

**NTP 서버(Time Server):**
시간 동기화를 위한 NTP 서버의 주소입니다. 시스템 시간을 정확하게 유지하는 데 사용됩니다. 로그 분석, 인증서 검증 등에서 중요합니다.

**WINS 서버(NetBIOS Name Server):**
Windows 환경에서 NetBIOS 이름 해석을 위한 서버 주소입니다. 레거시 시스템 지원을 위해 여전히 제공되는 경우가 있습니다.

**TFTP 서버와 부트 파일명:**
네트워크 부팅(PXE Boot)을 위한 정보입니다. 디스크가 없는 씬 클라이언트나 서버 설치 시 사용됩니다.

**라우터 목록:**
여러 라우터가 있을 때 사용 가능한 라우터 목록을 제공합니다. 장애 대응이나 로드 밸런싱에 활용됩니다.

**MTU(Maximum Transmission Unit):**
네트워크 인터페이스에서 사용할 최대 전송 단위를 지정합니다. 네트워크 환경에 맞는 최적값을 설정하여 단편화를 줄입니다.

**브로드캐스트 주소:**
해당 네트워크의 브로드캐스트 주소입니다. 서브넷 마스크로 계산할 수 있지만 명시적으로 제공하기도 합니다.

**Static Routes(정적 라우트):**
특정 목적지로 가는 경로를 지정합니다. 복잡한 네트워크 토폴로지에서 라우팅을 최적화합니다.

**Vendor-Specific Information:**
특정 벤더의 장비가 필요로 하는 사용자 정의 옵션입니다. IP 전화기, 셋톱박스 등이 자신에게 필요한 특수 설정을 받습니다.

**Proxy Auto-Configuration URL:**
웹 브라우저가 프록시 설정을 자동으로 받을 수 있는 URL입니다. 기업 환경에서 프록시 관리를 자동화합니다.

**DHCP 옵션 코드:**
이러한 정보들은 DHCP 옵션으로 구현됩니다. 각 정보는 고유한 옵션 번호를 가지며, 표준(RFC 2132) 또는 벤더별로 정의됩니다.

**실무 활용:**
가정용 네트워크에서는 IP, 서브넷, 게이트웨이, DNS 정도만 제공하지만, 기업 환경에서는 수십 가지 옵션을 설정하여 복잡한 네트워크를 자동 구성합니다.

---

## 43. DHCP의 유효기간은 얼마나 긴가요?

DHCP 임대 시간(Lease Time)은 **환경과 정책에 따라 다르며**, 일반적으로 **몇 시간에서 며칠** 사이입니다.

**일반적인 설정값:**
- **가정용 공유기**: 24시간(1일)이 가장 일반적입니다
- **기업 사무실**: 8시간에서 7일 사이
- **공공 Wi-Fi**: 30분에서 2시간
- **데이터센터**: 며칠에서 몇 주
- **무한대**: 이론적으로 가능하지만 권장되지 않습니다

**짧은 임대 시간의 장점:**
IP 주소가 빠르게 회수되어 재사용됩니다. 모바일 장치가 많은 환경에서 제한된 주소 풀을 효율적으로 사용합니다. 카페, 공항 등 사용자 이동이 잦은 곳에 적합합니다. 네트워크 설정 변경 시 빠르게 반영됩니다.

**짧은 임대 시간의 단점:**
갱신 트래픽이 증가하여 DHCP 서버와 네트워크 부하가 커집니다. 클라이언트가 자주 갱신 요청을 보내야 합니다. 서버 장애 시 임대 만료로 인한 영향이 빨리 나타납니다.

**긴 임대 시간의 장점:**
DHCP 서버 부하가 줄어듭니다. 네트워크 트래픽이 감소합니다. 서버가 일시적으로 다운되어도 클라이언트는 계속 동작합니다. 안정적인 환경에서 관리가 편리합니다.

**긴 임대 시간의 단점:**
IP 주소가 오래 묶여 있어 효율성이 떨어집니다. 오프라인 장치의 주소가 임대 만료까지 회수되지 않습니다. 네트워크 설정 변경이 천천히 반영됩니다.

**최적 값 선정 기준:**
- **사용자 이동성**: 높을수록 짧게 설정
- **IP 주소 풀 크기**: 부족할수록 짧게 설정
- **네트워크 안정성**: 안정적일수록 길게 설정
- **DHCP 서버 성능**: 성능이 좋을수록 짧게 설정 가능
- **정책 변경 빈도**: 잦을수록 짧게 설정

**갱신 타이밍:**
클라이언트는 임대 시간의 50%(T1 타이머)가 지나면 갱신을 시도합니다. 임대가 24시간이면 12시간 후 갱신을 요청합니다. 갱신에 실패하면 87.5%(T2 타이머) 시점에 재시도합니다. 최종 만료 전까지 여러 번 기회가 있어 안정적입니다.

**무한 임대:**
일부 시스템은 무한대(0xFFFFFFFF 초) 임대를 지원하지만 권장되지 않습니다. 네트워크 유연성이 떨어지고 관리가 어려워집니다. 예약(Reservation) 기능을 사용하는 것이 더 적절합니다.

**예약 vs 임대:**
서버, 프린터 등 고정 IP가 필요한 장치는 DHCP 예약을 사용합니다. 긴 임대 시간 대신 MAC 주소 기반 예약으로 동적 관리의 이점을 유지하면서 일관된 주소를 제공합니다.

**클라이언트 동작:**
임대가 만료되면 클라이언트는 IP 주소 사용을 중단하고 네트워크 연결이 끊어집니다. 갱신을 놓친 경우 처음부터 DORA 과정을 다시 시작합니다.

**실무 권장사항:**
대부분의 환경에서 24시간이 적절한 균형점입니다. 특수한 요구사항이 있는 경우에만 조정하며, 너무 짧거나 길게 설정하지 않도록 합니다.

**모니터링:**
DHCP 로그를 분석하여 주소 풀 사용률과 갱신 패턴을 파악하고, 필요시 임대 시간을 조정합니다.

---

## 44. IP 주소는 무엇이며, 어떤 기능을 하고 있나요?

**IP 주소(Internet Protocol Address)**는 네트워크에 연결된 장치를 고유하게 식별하는 논리적 주소입니다.

**기본 기능:**
IP 주소의 핵심 기능은 **식별(Identification)**과 **위치 지정(Location Addressing)**입니다. 인터넷 상의 무수히 많은 장치 중 특정 장치를 찾아내고, 그 장치까지 데이터를 전달할 수 있게 합니다.

**식별자 역할:**
각 장치는 고유한 IP 주소를 가지므로 네트워크에서 구별할 수 있습니다. 마치 집 주소가 특정 건물을 식별하듯이, IP 주소는 특정 컴퓨터나 서버를 식별합니다.

**라우팅 기능:**
IP 주소는 계층적 구조로 되어 있어 효율적인 라우팅이 가능합니다. 네트워크 부분은 어느 네트워크에 속하는지, 호스트 부분은 그 네트워크 내에서 어느 장치인지를 나타냅니다. 라우터는 네트워크 부분을 보고 패킷을 전달할 방향을 결정합니다.

**IPv4 주소 구조:**
32비트로 구성되며 일반적으로 점으로 구분된 4개의 십진수로 표현됩니다(예: 192.168.1.100). 각 부분은 0부터 255까지의 값을 가집니다. 이론적으로 약 43억 개의 주소가 가능합니다.

**IPv6 주소 구조:**
128비트로 구성되며 콜론으로 구분된 8개의 16진수 그룹으로 표현됩니다(예: 2001:0db8:85a3:0000:0000:8a2e:0370:7334). 약 340언데실리언 개의 주소가 가능하여 사실상 무한대입니다.

**주소 클래스:**
전통적으로 IPv4는 A, B, C, D, E 클래스로 분류되었습니다. 현재는 CIDR(Classless Inter-Domain Routing)로 유연하게 할당합니다.

**공인 IP vs 사설 IP:**
- **공인 IP**: 인터넷에서 유일하게 식별되는 주소로, ISP가 할당합니다
- **사설 IP**: 내부 네트워크에서만 사용되는 주소로, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 범위입니다

**특수 IP 주소:**
- **127.0.0.1**: 루프백 주소로 자기 자신을 가리킵니다
- **0.0.0.0**: 모든 인터페이스 또는 알 수 없는 주소를 의미합니다
- **255.255.255.255**: 제한된 브로드캐스트 주소입니다
- **169.254.x.x**: APIPA로 DHCP 실패 시 자동 할당됩니다

**동적 vs 정적 할당:**
- **정적 IP**: 수동으로 설정되어 변하지 않습니다. 서버, 네트워크 장비에 사용됩니다
- **동적 IP**: DHCP로 자동 할당되며 변할 수 있습니다. 일반 사용자 장치에 사용됩니다

**서브넷팅:**
큰 네트워크를 작은 서브넷으로 나누어 효율적으로 관리합니다. 서브넷 마스크로 네트워크 경계를 정의합니다.

**NAT(Network Address Translation):**
사설 IP를 공인 IP로 변환하여 제한된 공인 IP 주소를 효율적으로 사용합니다. 가정이나 기업의 여러 장치가 하나의 공인 IP를 공유합니다.

**OSI 모델에서의 위치:**
IP는 네트워크 계층(3계층) 프로토콜입니다. 데이터링크 계층의 MAC 주소와 함께 사용되어 패킷을 목적지까지 전달합니다.

**실무 활용:**
웹 사이트 접속, 이메일 전송, 파일 공유 등 모든 네트워크 통신의 기반입니다. 보안, 접근 제어, 트래픽 분석 등에도 활용됩니다.

**IPv4 고갈 문제:**
인터넷 성장으로 IPv4 주소가 고갈되어 IPv6 전환이 진행 중입니다. NAT, CIDR 등으로 IPv4 수명을 연장하고 있습니다.
