# Network 답변 모음 (97-100)

## 97. 로드밸런서 장치를 사용하지 않고, DNS를 활용해서 유사하게 로드밸런싱을 하는 방법에 대해 설명해 주세요.

**DNS 기반 로드밸런싱**은 DNS 응답에 여러 IP 주소를 포함하거나 조건에 따라 다른 IP를 반환하여 트래픽을 분산하는 방법입니다.

**DNS Round Robin:**

**원리:**
하나의 도메인에 여러 A 레코드(IP 주소)를 등록합니다. DNS 서버가 쿼리마다 IP 주소 순서를 순환하여 응답합니다.

**설정 예시:**
```
example.com.    IN  A   192.0.2.1
example.com.    IN  A   192.0.2.2
example.com.    IN  A   192.0.2.3
```

**동작:**
- 첫 번째 클라이언트: 192.0.2.1, 192.0.2.2, 192.0.2.3 받음
- 두 번째 클라이언트: 192.0.2.2, 192.0.2.3, 192.0.2.1 받음
- 세 번째 클라이언트: 192.0.2.3, 192.0.2.1, 192.0.2.2 받음

클라이언트는 일반적으로 첫 번째 IP를 사용하므로 분산 효과가 있습니다.

**장점:**
설정이 간단하고 추가 장비가 필요 없습니다. 비용이 들지 않습니다. DNS 인프라만 있으면 됩니다.

**단점:**

**캐싱 문제:**
DNS 응답이 캐싱되어 실시간 분산이 어렵습니다. TTL 동안 같은 IP를 계속 사용할 수 있습니다.

**헬스 체크 없음:**
서버 장애를 자동으로 감지하지 못합니다. 다운된 서버의 IP도 계속 응답에 포함됩니다.

**불균등 분산:**
클라이언트가 항상 첫 번째 IP를 선택하지 않을 수 있습니다. 캐시, 네트워크 조건에 따라 불균등해집니다.

**세션 유지 어려움:**
사용자가 재접속 시 다른 서버로 연결될 수 있습니다.

**GeoDNS (지리적 DNS):**

**원리:**
클라이언트의 지리적 위치에 따라 다른 IP 주소를 반환합니다. 가까운 데이터센터로 연결하여 지연을 최소화합니다.

**동작:**
- 한국 클라이언트 → 한국 데이터센터 IP
- 미국 클라이언트 → 미국 데이터센터 IP
- 유럽 클라이언트 → 유럽 데이터센터 IP

**장점:**
지연 시간을 크게 줄입니다. 지역별 규정 준수(데이터 주권)에 유리합니다.

**제공자:**
AWS Route 53, Cloudflare, Google Cloud DNS, Akamai.

**가중 Round Robin:**

**원리:**
각 서버에 가중치를 부여합니다. 가중치에 비례하여 IP를 응답합니다.

**예시:**
- Server A (가중치 3): 60% 트래픽
- Server B (가중치 2): 40% 트래픽

**사용:**
점진적 배포(Canary), 서버 성능 차이 반영.

**헬스 체크 통합:**

**DNS 헬스 체크:**
일부 DNS 서비스는 서버 상태를 모니터링합니다. 다운된 서버의 IP를 응답에서 자동 제외합니다. 복구되면 다시 포함합니다.

**예시:**
AWS Route 53, Google Cloud DNS는 헬스 체크를 지원합니다. 엔드포인트에 주기적으로 요청을 보내 상태를 확인합니다.

**장애 조치(Failover):**

**Primary-Secondary 구조:**
정상 시에는 Primary 서버 IP를 반환합니다. Primary 다운 시 자동으로 Secondary IP로 전환합니다.

**설정:**
헬스 체크를 Primary에 설정합니다. 실패 시 DNS가 자동으로 Secondary를 반환합니다.

**Latency-Based Routing:**

**원리:**
클라이언트에게 가장 낮은 지연 시간을 제공하는 서버를 선택합니다. 실제 네트워크 지연을 측정하여 결정합니다.

**장점:**
지리적 위치보다 실제 성능을 반영합니다.

**TTL 관리:**

**짧은 TTL:**
빠른 변경 적용을 위해 TTL을 짧게(60초~5분) 설정합니다. 서버 추가/제거, 장애 조치가 빠릅니다.

**단점:**
DNS 쿼리가 증가하여 DNS 서버 부하가 커집니다.

**긴 TTL:**
DNS 쿼리를 줄여 성능을 향상시킵니다. 하지만 변경 적용이 느립니다.

**권장:**
일반적으로 5분~1시간이 적절합니다.

**DNS 로드밸런싱 vs 전용 로드밸런서:**

**DNS의 장점:**
비용이 저렴하거나 무료입니다. 설정이 간단합니다. 추가 인프라가 필요 없습니다. 지리적 분산에 효과적입니다.

**DNS의 단점:**
실시간 헬스 체크가 제한적입니다. 세션 유지가 어렵습니다. 세밀한 제어가 불가능합니다. 캐싱으로 인한 지연이 있습니다.

**전용 로드밸런서의 장점:**
실시간 헬스 체크와 자동 제외를 수행합니다. 정교한 알고리즘을 사용합니다. 세션 유지, SSL 종료 등 고급 기능을 제공합니다.

**하이브리드 접근:**

**DNS + 로드밸런서:**
DNS로 지역별 로드밸런서를 선택합니다. 각 로드밸런서가 해당 지역 서버를 관리합니다. 글로벌 분산과 로컬 최적화를 동시에 달성합니다.

**실무 사용:**

**소규모:**
비용 절감을 위해 DNS Round Robin 사용.

**중규모:**
GeoDNS + 헬스 체크로 기본 고가용성 확보.

**대규모:**
DNS(글로벌 분산) + 로드밸런서(로컬 분산) 조합.

**주의사항:**
DNS 캐싱을 고려한 설계가 필요합니다. 백업 계획이 필수적입니다. 모니터링으로 분산 효과를 검증합니다.

---

## 98. 서브넷 마스크와, 게이트웨이에 대해 설명해 주세요.

**서브넷 마스크(Subnet Mask)**와 **게이트웨이(Gateway)**는 IP 네트워킹의 핵심 개념입니다.

**서브넷 마스크:**

**정의:**
IP 주소에서 네트워크 부분과 호스트 부분을 구분하는 32비트 값입니다.

**역할:**
같은 네트워크에 있는지 판단합니다. 네트워크 크기를 정의합니다. 효율적인 IP 주소 관리를 가능하게 합니다.

**형식:**

**점 십진 표기:**
255.255.255.0 형태로 표현합니다.

**CIDR 표기:**
/24 형태로 표현합니다(1비트 개수).

**비트 패턴:**
네트워크 부분은 1, 호스트 부분은 0으로 표시합니다.

**예시:**

**255.255.255.0 (/24):**
이진: 11111111.11111111.11111111.00000000
네트워크 비트: 24개, 호스트 비트: 8개
가능한 호스트: 256개 (사용 가능: 254개)

**IP 주소 192.168.1.100/24:**
- IP: 192.168.1.100
- 서브넷 마스크: 255.255.255.0
- 네트워크 주소: 192.168.1.0
- 브로드캐스트 주소: 192.168.1.255
- 사용 가능한 호스트: 192.168.1.1 ~ 192.168.1.254

**계산 방법:**

**네트워크 주소:**
IP AND 서브넷 마스크 = 네트워크 주소
192.168.1.100 AND 255.255.255.0 = 192.168.1.0

**브로드캐스트 주소:**
네트워크 주소 OR (NOT 서브넷 마스크)

**같은 네트워크 판단:**
두 IP의 네트워크 주소가 같으면 같은 네트워크입니다.

**예시:**
- 192.168.1.100/24와 192.168.1.200/24: 같은 네트워크
- 192.168.1.100/24와 192.168.2.100/24: 다른 네트워크

**서브넷팅:**

**목적:**
큰 네트워크를 작은 서브넷으로 분할합니다. IP 주소를 효율적으로 사용합니다. 보안과 관리를 개선합니다.

**예시:**
192.168.1.0/24를 4개 서브넷으로 분할:
- 192.168.1.0/26 (192.168.1.0 ~ 192.168.1.63)
- 192.168.1.64/26 (192.168.1.64 ~ 192.168.1.127)
- 192.168.1.128/26 (192.168.1.128 ~ 192.168.1.191)
- 192.168.1.192/26 (192.168.1.192 ~ 192.168.1.255)

**게이트웨이(Gateway):**

**정의:**
서로 다른 네트워크를 연결하는 장치(일반적으로 라우터)의 IP 주소입니다.

**역할:**
다른 네트워크로 패킷을 전달합니다. 기본 게이트웨이는 알 수 없는 목적지로 가는 패킷의 출구입니다.

**동작:**

**같은 네트워크:**
목적지가 같은 네트워크에 있으면 직접 전송합니다. ARP로 목적지 MAC 주소를 찾아 전송합니다.

**다른 네트워크:**
목적지가 다른 네트워크에 있으면 게이트웨이로 전송합니다. 게이트웨이가 패킷을 라우팅합니다.

**기본 게이트웨이(Default Gateway):**

**정의:**
특정 경로가 없는 모든 트래픽을 보낼 라우터입니다. 일반적으로 인터넷으로 나가는 출구입니다.

**예시:**
홈 네트워크에서 공유기가 기본 게이트웨이입니다. 공유기 IP: 192.168.1.1 (일반적).

**설정:**
수동: 관리자가 직접 입력합니다. DHCP: 자동으로 할당받습니다.

**패킷 전송 예시:**

**시나리오:**
PC: 192.168.1.100/24, 게이트웨이: 192.168.1.1
목적지: www.google.com (142.250.185.46)

**과정:**
1. PC가 목적지 IP와 자신의 네트워크를 비교합니다
2. 다른 네트워크이므로 게이트웨이로 전송 결정합니다
3. ARP로 게이트웨이(192.168.1.1)의 MAC 주소를 찾습니다
4. 패킷의 목적지 IP는 142.250.185.46이지만, 이더넷 프레임의 목적지 MAC은 게이트웨이의 MAC입니다
5. 게이트웨이가 패킷을 받아 라우팅합니다

**여러 게이트웨이:**

**복수 인터페이스:**
여러 네트워크 인터페이스가 있을 때 각각 다른 게이트웨이를 가질 수 있습니다.

**정적 라우트:**
특정 목적지로 가는 패킷은 특정 게이트웨이를 사용하도록 설정합니다.

**메트릭:**
여러 게이트웨이가 있을 때 메트릭으로 우선순위를 결정합니다.

**라우팅 테이블:**

**예시:**
```
목적지          서브넷마스크    게이트웨이      인터페이스
192.168.1.0    255.255.255.0   직접연결        eth0
10.0.0.0       255.0.0.0       192.168.1.1     eth0
0.0.0.0        0.0.0.0         192.168.1.1     eth0
```

**0.0.0.0/0:**
기본 게이트웨이를 나타냅니다. 모든 알 수 없는 목적지에 매칭됩니다.

**문제 해결:**

**ping 테스트:**
같은 네트워크 호스트에 ping: 네트워크 연결 확인. 게이트웨이에 ping: 게이트웨이 연결 확인. 외부 IP에 ping: 인터넷 연결 확인.

**traceroute:**
패킷이 거치는 게이트웨이 목록을 확인합니다.

**잘못된 설정:**
서브넷 마스크나 게이트웨이가 잘못되면 통신이 불가능합니다. 게이트웨이가 같은 네트워크에 없으면 도달할 수 없습니다.

**실무 예시:**

**가정 네트워크:**
IP: 192.168.0.100
서브넷 마스크: 255.255.255.0
게이트웨이: 192.168.0.1 (공유기)

**기업 네트워크:**
IP: 10.1.2.100
서브넷 마스크: 255.255.255.0 (/24)
게이트웨이: 10.1.2.1 (라우터)

---

## 99. NAT에 대해 설명해 주세요.

**NAT(Network Address Translation)**는 IP 주소를 변환하는 기술로, 주로 사설 IP를 공인 IP로 변환하는 데 사용됩니다.

**필요성:**

**IPv4 주소 고갈:**
공인 IP 주소가 부족합니다. 모든 장치에 공인 IP를 할당할 수 없습니다. NAT로 여러 장치가 하나의 공인 IP를 공유합니다.

**보안:**
내부 네트워크 구조를 외부에서 숨깁니다. 직접적인 외부 접근을 차단합니다.

**동작 원리:**

**기본 NAT:**
1. 내부 호스트(192.168.1.100)가 외부(8.8.8.8)로 패킷을 보냅니다
2. NAT 라우터가 송신 IP를 공인 IP(203.0.113.1)로 변환합니다
3. 외부 서버는 203.0.113.1로부터 패킷을 받은 것으로 인식합니다
4. 응답 패킷이 203.0.113.1로 돌아옵니다
5. NAT 라우터가 목적지 IP를 192.168.1.100으로 변환합니다
6. 내부 호스트가 응답을 받습니다

**NAT 테이블:**
NAT 라우터는 변환 정보를 테이블에 저장합니다.
```
내부 IP:포트        외부 IP:포트        목적지 IP:포트
192.168.1.100:50123 203.0.113.1:50123  8.8.8.8:53
192.168.1.101:50124 203.0.113.1:50124  1.1.1.1:443
```

**NAT 유형:**

**1. SNAT (Source NAT):**
송신자 IP 주소를 변환합니다. 내부에서 외부로 나가는 트래픽에 사용합니다. 일반적인 홈 네트워크 NAT입니다.

**2. DNAT (Destination NAT):**
목적지 IP 주소를 변환합니다. 외부에서 내부로 들어오는 트래픽에 사용합니다. 포트 포워딩이 대표적입니다.

**3. PAT (Port Address Translation, NAPT):**
IP 주소와 포트를 모두 변환합니다. 여러 내부 호스트가 하나의 공인 IP를 공유합니다. 가장 일반적인 NAT 방식입니다.

**4. Static NAT:**
내부 IP와 공인 IP를 1:1로 고정 매핑합니다. 서버 등에 사용합니다.

**5. Dynamic NAT:**
공인 IP 풀에서 동적으로 할당합니다. 동시 접속자 수만큼 공인 IP가 필요합니다.

**포트 포워딩(Port Forwarding):**

**목적:**
외부에서 내부 서버로 접근을 허용합니다.

**설정:**
공인 IP의 특정 포트를 내부 IP의 특정 포트로 매핑합니다. 예: 203.0.113.1:80 → 192.168.1.10:80 (웹 서버)

**예시:**
외부 사용자가 공유기 IP:80으로 접속하면 내부 웹 서버(192.168.1.10:80)로 연결됩니다.

**장점:**

**IP 절약:**
수백 대의 장치가 하나의 공인 IP를 사용합니다. IPv4 고갈 문제를 완화합니다.

**보안:**
내부 IP가 외부에 노출되지 않습니다. 외부에서 내부로의 직접 접근이 차단됩니다(포트 포워딩 제외).

**유연성:**
내부 네트워크를 자유롭게 설계할 수 있습니다.

**단점:**

**엔드투엔드 연결 방해:**
진정한 엔드투엔드 통신이 불가능합니다. 일부 프로토콜(FTP, VoIP)에서 문제가 발생할 수 있습니다.

**성능:**
NAT 처리로 인한 지연이 발생합니다. 라우터 부하가 증가합니다.

**복잡성:**
포트 포워딩, 알리지 등 추가 설정이 필요합니다.

**P2P 통신 어려움:**
양쪽이 모두 NAT 뒤에 있으면 직접 연결이 어렵습니다. NAT 트래버설(STUN, TURN) 기술이 필요합니다.

**NAT 트래버설:**

**STUN (Session Traversal Utilities for NAT):**
NAT의 외부 IP와 포트를 확인합니다. 이를 상대방에게 알려 P2P 연결을 시도합니다.

**TURN (Traversal Using Relays around NAT):**
직접 연결이 불가능하면 중계 서버를 통해 통신합니다.

**ICE (Interactive Connectivity Establishment):**
STUN과 TURN을 결합한 프레임워크입니다. WebRTC에서 사용합니다.

**Carrier-Grade NAT (CGN):**

**정의:**
ISP 레벨에서 대규모 NAT를 수행합니다. 여러 가정이 하나의 공인 IP를 공유합니다(이중 NAT).

**문제:**
포트 포워딩이 불가능하거나 매우 복잡합니다. 일부 애플리케이션이 동작하지 않을 수 있습니다.

**IPv6와 NAT:**

**IPv6의 충분한 주소:**
NAT의 주요 이유(주소 부족)가 사라집니다. 모든 장치가 공인 IP를 가질 수 있습니다.

**NAT의 미래:**
IPv6 환경에서도 보안을 위해 NAT를 사용할 수 있습니다. 하지만 엔드투엔드 연결이 IPv6의 철학입니다.

**실무 예시:**

**홈 네트워크:**
공유기가 NAT를 수행합니다. 내부: 192.168.x.x, 외부: ISP가 할당한 공인 IP.

**기업 네트워크:**
방화벽이나 라우터가 NAT를 수행합니다. 다수의 공인 IP 풀을 사용할 수 있습니다.

---

## 100. 서브넷 마스크의 표현 방식에 대해 설명해 주세요.

**서브넷 마스크**는 네트워크와 호스트 부분을 구분하며, 여러 방식으로 표현할 수 있습니다.

**1. 점 십진 표기(Dotted Decimal Notation):**

**형식:**
4개의 십진수를 점으로 구분합니다. 예: 255.255.255.0

**일반적인 값:**
- 255.255.255.0 (클래스 C 기본)
- 255.255.0.0 (클래스 B 기본)
- 255.0.0.0 (클래스 A 기본)
- 255.255.255.128 (/25)
- 255.255.255.192 (/26)

**이진수 변환:**
255 = 11111111 (모두 1)
0 = 00000000 (모두 0)

**2. CIDR 표기(Classless Inter-Domain Routing):**

**형식:**
슬래시 뒤에 네트워크 비트 수를 표시합니다. 예: /24

**의미:**
/24 = 앞의 24비트가 네트워크 부분입니다.

**변환:**
- /24 = 255.255.255.0
- /16 = 255.255.0.0
- /8 = 255.0.0.0

**장점:**
간결하고 명확합니다. 가변 길이 서브넷 마스크(VLSM)를 표현하기 쉽습니다. 현대 네트워킹에서 표준입니다.

**3. 이진 표기:**

**형식:**
32비트 이진수로 표현합니다. 네트워크 부분은 1, 호스트 부분은 0입니다.

**예시:**
255.255.255.0 = 11111111.11111111.11111111.00000000

**직관성:**
네트워크와 호스트 경계가 명확합니다.

**4. 16진수 표기:**

**형식:**
0x로 시작하는 16진수입니다.

**예시:**
255.255.255.0 = 0xFFFFFF00

**사용:**
프로그래밍, 저수준 네트워크 설정에서 사용합니다.

**변환 예시:**

**255.255.255.0:**
- 점 십진: 255.255.255.0
- CIDR: /24
- 이진: 11111111.11111111.11111111.00000000
- 16진: 0xFFFFFF00
- 네트워크 비트: 24개
- 호스트 비트: 8개

**255.255.255.128:**
- 점 십진: 255.255.255.128
- CIDR: /25
- 이진: 11111111.11111111.11111111.10000000
- 네트워크 비트: 25개
- 호스트 비트: 7개

**유효한 서브넷 마스크:**

**규칙:**
왼쪽부터 연속된 1, 오른쪽부터 연속된 0이어야 합니다. 1과 0이 섞일 수 없습니다.

**유효:**
- 11111111.11111111.11111111.00000000 (O)
- 11111111.11111111.11110000.00000000 (O)

**무효:**
- 11111111.11111111.00000000.11111111 (X) - 1과 0이 섞임
- 11111111.11111111.11111111.01010101 (X) - 1과 0이 교차

**가능한 서브넷 마스크 값:**

**/8부터 /30까지:**
- /8: 255.0.0.0 (1,677만 호스트)
- /16: 255.255.0.0 (6.5만 호스트)
- /24: 255.255.255.0 (254 호스트)
- /25: 255.255.255.128 (126 호스트)
- /26: 255.255.255.192 (62 호스트)
- /27: 255.255.255.224 (30 호스트)
- /28: 255.255.255.240 (14 호스트)
- /29: 255.255.255.248 (6 호스트)
- /30: 255.255.255.252 (2 호스트, P2P 링크용)
- /31: 255.255.255.254 (RFC 3021, P2P 전용)
- /32: 255.255.255.255 (호스트 라우트, 단일 IP)

**호스트 수 계산:**
2^(32-prefix) - 2 = 사용 가능한 호스트 수
(네트워크 주소와 브로드캐스트 주소 제외)

**예시:**
/24: 2^(32-24) - 2 = 2^8 - 2 = 256 - 2 = 254 호스트

**VLSM (Variable Length Subnet Mask):**

**정의:**
하나의 네트워크를 다양한 크기의 서브넷으로 나눕니다. 필요에 따라 다른 서브넷 마스크를 사용합니다.

**예시:**
192.168.1.0/24를 분할:
- 192.168.1.0/26 (62 호스트) - 서버용
- 192.168.1.64/27 (30 호스트) - 사무실 A
- 192.168.1.96/27 (30 호스트) - 사무실 B
- 192.168.1.128/25 (126 호스트) - 직원용

**장점:**
IP 주소를 효율적으로 사용합니다. 네트워크를 유연하게 설계할 수 있습니다.

**표기 방법 선택:**

**설정 파일:**
일반적으로 점 십진 표기를 사용합니다.

**라우팅 테이블:**
CIDR 표기가 간결하고 명확합니다.

**문서화:**
CIDR 표기가 현대적이고 표준적입니다.

**프로그래밍:**
이진수나 16진수로 비트 연산을 수행합니다.

**실무 권장:**
CIDR 표기(/24 형식)를 기본으로 사용하고, 필요시 점 십진 표기를 병기합니다. 예: 192.168.1.0/24 (255.255.255.0)
